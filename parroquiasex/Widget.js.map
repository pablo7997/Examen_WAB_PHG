{"version":3,"sources":["../../../widgets/parroquiasex/Widget.js"],"names":["define","declare","BaseWidget","QueryTask","Query","lang","Graphic","SimpleFillSymbol","SpatialReference","Extent","baseClass","cargaconcellos","codigoProvincia","selectProvincias","value","selectConcellos","innerHTML","miqueryTask","config","serviceconcellos","miquery","returnGeometry","outFields","orderByFields","where","execute","hitch","results","opcionpordefecto","document","createElement","text","add","i","features","length","attributes","CODCONC","CONCELLO","cargaParroquias","codigoparroquia","miqueryTask2","serviceparroquia","miquery2","results2","opcionpordefecto2","selectParroquias","console","log","CODPARRO","PARROQUIA","zoomConcello","miqueryTask3","miquery3","outSpatialReference","geometria","geometry","map","graphics","clear","setExtent","getExtent","zoomParroquia","miqueryTask4","miquery4","geometria2"],"mappings":"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","file":"Widget.js","sourcesContent":["define(['dojo/_base/declare', 'jimu/BaseWidget', \"esri/tasks/QueryTask\", \"esri/tasks/query\", \r\n\"dojo/_base/lang\",\"esri/graphic\",\r\n\"esri/symbols/SimpleFillSymbol\", \"esri/SpatialReference\",\"esri/geometry/Extent\"],\r\nfunction(declare, BaseWidget, QueryTask, Query, lang, Graphic, SimpleFillSymbol, SpatialReference, Extent) {\r\n  //To create a widget, you need to derive from BaseWidget.\r\n  return declare([BaseWidget], {\r\n\r\n    // Custom widget code goes here\r\n\r\n    baseClass: 'parroquiasex',\r\n    \r\n\r\n    cargaconcellos: function(){\r\n\r\n      let codigoProvincia = this.selectProvincias.value;\r\n      if(codigoProvincia == -1) return;\r\n\r\n      this.selectConcellos.innerHTML = \"\";\r\n\r\n      const miqueryTask = new QueryTask(this.config.serviceconcellos);\r\n      const miquery = new Query();\r\n      miquery.returnGeometry = false;\r\n      miquery.outFields = [\"CODCONC\", \"CONCELLO\"];\r\n      miquery.orderByFields = [\"CONCELLO\"];\r\n      miquery.where = \"CODPROV = \" + codigoProvincia;\r\n\r\n      miqueryTask.execute(miquery, lang.hitch(this, function(results){\r\n\r\n        let opcionpordefecto = document.createElement(\"option\");\r\n        opcionpordefecto.value = -1;\r\n        opcionpordefecto.text = \"Seleccione un Concello\";\r\n        this.selectConcellos.add(opcionpordefecto);\r\n\r\n        for (let i = 0; i < results.features.length; i++) {\r\n          opcionpordefecto = document.createElement(\"option\");\r\n          opcionpordefecto.value = results.features[i].attributes.CODCONC;\r\n          opcionpordefecto.text = results.features[i].attributes.CONCELLO;\r\n          this.selectConcellos.add(opcionpordefecto);\r\n        }\r\n      }))\r\n      \r\n    },\r\n    cargaParroquias: function(){\r\n      let codigoparroquia = this.selectConcellos.value;\r\n      if(codigoparroquia == -1) return;\r\n\r\n      \r\n\r\n      const miqueryTask2 = new QueryTask(this.config.serviceparroquia);\r\n      const miquery2 = new Query();\r\n      miquery2.returnGeometry = false;\r\n      miquery2.outFields = [\"CODPARRO\", \"PARROQUIA\"];\r\n      miquery2.orderByFields = [\"PARROQUIA\"];\r\n      miquery2.where = \"CODCONC = \" + codigoparroquia;\r\n\r\n      miqueryTask2.execute(miquery2, lang.hitch(this, function(results2){\r\n\r\n        let opcionpordefecto2 = document.createElement(\"option\");\r\n        opcionpordefecto2.value = -1;\r\n        opcionpordefecto2.text = \"Seleccione una Parroquia\";\r\n        this.selectParroquias.add(opcionpordefecto2);\r\n        console.log(results2)\r\n        for (let i = 0; i < results2.features.length; i++) {\r\n          opcionpordefecto2 = document.createElement(\"option\");\r\n          opcionpordefecto2.value = results2.features[i].attributes.CODPARRO;\r\n          opcionpordefecto2.text = results2.features[i].attributes.PARROQUIA;\r\n          this.selectParroquias.add(opcionpordefecto2);\r\n        }\r\n      }))\r\n    \r\n    },\r\n\r\n    zoomConcello: function(){\r\n\r\n      const miqueryTask3 = new QueryTask(this.config.serviceconcellos);\r\n      const miquery3 = new Query();\r\n      miquery3.returnGeometry = true\r\n      miquery3.where = \"CODCONC = \" + this.selectConcellos.value;\r\n\r\n      miquery3.outSpatialReference = new SpatialReference(102100); \r\n\r\n      miqueryTask3.execute(miquery3, lang.hitch(this, function(results){\r\n        if(results.features.length > 0){\r\n          let geometria = results.features[0].geometry;\r\n          this.map.graphics.clear();\r\n          this.map.graphics.add(new Graphic(geometria, new SimpleFillSymbol()));\r\n          this.map.setExtent(geometria.getExtent(), true);\r\n        }\r\n      }))\r\n\r\n    },\r\n\r\n    zoomParroquia: function(){\r\n\r\n      const miqueryTask4 = new QueryTask(this.config.serviceparroquia);\r\n      const miquery4 = new Query();\r\n      miquery4.returnGeometry = true\r\n      miquery4.where = \"CODPARRO = \" +  this.selectParroquias.value;\r\n      console.log(this.selectParroquias)\r\n      miquery4.outSpatialReference = new SpatialReference(102100);\r\n      console.log(miquery4)\r\n      miqueryTask4.execute(miquery4, lang.hitch(this, function(results){\r\n        console.log(results)\r\n        if(results.features.length > 0){\r\n          let geometria2 = results.features[0].geometry;\r\n          this.map.graphics.clear();\r\n          this.map.graphics.add(new Graphic(geometria2, new SimpleFillSymbol()));\r\n          this.map.setExtent(geometria2.getExtent(), true);\r\n        }\r\n\r\n      }))\r\n    },\r\n\r\n    //methods to communication between widgets:\r\n\r\n  });\r\n\r\n});\r\n"]}